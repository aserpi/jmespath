[jmespath-command]
syntax = jmespath (default=<string>)? (errors=<wc-field>)? (input=<field>)? (mvexpand=<bool>)? (output=<wc-field>)? query=<jmespath-expression>
shortdesc = Uses a JMESpath expression to extract and process elements from a \
    JSON document. \
    Simple extractions are similar to "spath", but advanced queries can simplify \
    a Splunk search by eliminating the need for additional post-processing \
    commands.
description = Extracts and manipulates data from a JSON document using JMESPath \
    expressions. \
    The default input field is "_raw" and the default output field is \
    "jmespath", but they can be changed. \
    \p\\
    Syntax help and tutorials available at <jmespath.site>. \
    The following functions have been added to the one defined by the JMESPath \
    Community standard to simplify common Splunk use cases: \i\\
        * "parse_json(@)" parses a JSON or array from a string \i\\
        * "unroll(@, key, value, [mode])" creates an object from an array of objects with key/value pairs
comment1 = Extract all the URLs from the "relatedContent" object
example1 = ... | jmespath output="url" query="relatedContent[].url"
comment2 = Unroll a list of nested JSON objects into a set of fields with a \
    custom prefix. \
    If a raw event is {"config": [{"Name": "ip", "Value": "10.1.1.9"}]}, then \
    cfg.ip="10.1.1.9".
example2 = ... | jmespath output="cfg.*" query="config[] | unroll(@, 'Name', 'Value')"
comment3 = Extract a nested JSON contained within a Microsoft Office 365 Management Activity event
example3 = ... | jmespath output="additionalTargets" query="ExtendedProperties[?Name=='additionalTargets'].Value | parse_json(@)"
maintainer = aserpi
related = eval, spath
usage = public
tags = json

[jsonformat-command]
syntax = jsonformat (indent=<int>)? <jsonformat-order-option>? (errors=<field>)? <jsonformat-input_mode-option>? <jsonformat-output_mode-option>? (<field> (as <field>)?)*
shortdesc = Reformats, validates, and/or reorders JSON documents in one or more
    fields. \
    Format JSON. \
    Any validation errors are reported to the field specified to the "errors" field. \p\\
    Splunk shows JSON events with color coding and nested sections can be expanded as needed.  However, in \
    deeply nested or highly repetitive structures opening these manually can slow you down. \
    Another use case is normalizing JSON representations for comparison purposes.
description =
comment1 = Format the body of a JSON event.  From the Events tab, click "Show as raw text".
example1 = ... | jsonformat
comment2 = Format a JSON string and store redirect the formatted output in a new field
example2 = ... | jsonformat json as json_formatted
comment3 = Validate a JSON field and show all invalid values
example3 = ... | jsonformat myfield errors=myfield_errors | where myfield_errors!="none"
# Only top 3 are shown the UI by default at this time.
comment4 = Format the body of a JSON event and sort keys
example4 = ... | jsonformat order=sort
comment5 = Compare 2 different JSON objects which have a different key order
example5 = ... | jsonformat order=sort a as a_sorted, b as b_sorted | where a_sorted!=b_sorted | table a_sorted b_sorted
comment6 = Convert a Python literal (repr format) to json.  This allows for further processing via 'spath' or 'jmespath'. \
           (WARNING:  This is not officially supported at this time)
example6 = ... | jsonformat input_mode=python pydict as json | spath input=json ...
comment7 = Convert complex JSON object into a SPL run-anywhere snippet (e.g., to post to Splunk Answers)
example7 = ... | jsonformat output_mode=makeresults _raw | table _raw
maintainer = aserpi
related = jmespath
usage = public
tags = json

[jsonformat-order-option]
syntax = order=(preserve|sort)
description = \
    If order is PRESERVE then the representation order is preserved in the formatted output.  This is the default because it's what most people want. \
    If order is SORT then all hash keys are sorted lexicographically.   This gives a more consistent result.
default = "order=preserve"

[jsonformat-input_mode-option]
syntax = input_mode=(json|python)
description = \
    UNDOCUMENTED / UNSUPPORTED FEATURE  (It normally works, but it's not officially supported at this time.) \
    By default, input is expected to be 'JSON'.   However, this command can be used to parse Python representation \
    strings (literals only) which is sometimes provided by the internal logs of TAs for example.  Once converted to \
    json, other JSON specific commands can be used to manipulate the data.
default = "input_mode=json"

[jsonformat-output_mode-option]
syntax = output_mode=(json|makeresults)
description = \
    Use 'makeresults' if you'd like to build a run-anywhere JSON parsing example.  \
    This is useful when posting a complex JSON object on Splunk Answers, for example. \
    Otherwise this option has NO valueT and should be avoided.
default = "input_mode=json"
